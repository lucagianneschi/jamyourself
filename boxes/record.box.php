<?php/* ! \par		Info Generali: * \author		Luca Gianneschi * \version		1.0 * \date		2013 * \copyright		Jamyourself.com 2013 * \par			Info Classe: * \brief		box caricamento info event * \details		Recupera le informazioni dell'evento, le inserisce in un array da passare alla view * \par			Commenti: * \warning * \bug * \todo		 * */if (!defined('ROOT_DIR'))    define('ROOT_DIR', '../');require_once ROOT_DIR . 'config.php';require_once CLASSES_DIR . 'record.class.php';require_once CLASSES_DIR . 'recordParse.class.php';class RecordBox {    public $config;    public $error;    public $fromUserInfo;    public $recordArray;    /**     * \fn	__construct()     * \brief	class construct to import config file     */    function __construct() {	$this->config = json_decode(file_get_contents(CONFIG_DIR . "boxes/record.config.json"), false);    }    /**     * \fn	initForMediaPage($objectId)     * \brief	init for Media Page     * \param	$objectId of the record to display in Media Page     * \todo         */    public function initForMediaPage($objectId) {	$recordP = new RecordParse();	$recordP->where('objectId', $objectId);	$recordP->where('active', true);	$recordP->whereInclude('fromUser');	$recordP->setLimit($this->config->limitRecordForMediaPage);	$records = $recordP->getRecords();	if ($records instanceof Error) {	    $this->error = $records->getErrorMessage();	    $this->recordArray = array();	    $this->fromUserInfo = null;	    return;	} elseif (is_null($records)) {	    $this->error = null;	    $this->recordArray = array();	    $this->fromUserInfo = null;	    return;	} else {	    $this->error = null;	    $this->fromUserInfo = (!is_null($records[0]->getFromUser())) ? null : $records[0]->getFromUser();	    $this->recordArray = $records[0];	}    }    /**     * \fn	initForPersonalPage($objectId)     * \brief	init for recordBox for personal Page     * \param	$objectId of the user who owns the page     * \todo	     */    public function initForPersonalPage($objectId) {	$this->fromUserInfo = null;	$record = new RecordParse();	$record->wherePointer('fromUser', '_User', $objectId);	$record->where('active', true);	$record->setLimit($this->config->limitRecordForPersonalPage);	$record->orderByDescending('createdAt');	$records = $record->getRecords();	if ($records instanceof Error) {	    $this->error = $records->getErrorMessage();	    $this->recordArray = null;	    return;	} elseif (is_null($records)) {	    $this->error = null;	    $this->recordArray = null;	    return;	} else {	    $this->error = null;	    $this->recordArray = $records;	}    }    /**     * \fn	initForUploadRecordPage($objectId)     * \brief	init for recordBox for upload record page     * \param	$objectId of the user who owns the record     */    public function initForUploadRecordPage($objectId) {	$this->fromUserInfo = null;	$record = new RecordParse();	$record->wherePointer('fromUser', '_User', $objectId);	$record->where('active', true);	$record->setLimit($this->config->limitRecordForUploadRecordPage);	$record->orderByDescending('createdAt');	$records = $record->getRecords();	if ($records instanceof Error) {	    $this->error = $records->getErrorMessage();	    $this->recordArray = array();	    return;	} elseif (is_null($records)) {	    $this->error = null;	    $this->recordArray = array();	    return;	} else {	    $this->error = null;	    $this->recordArray = $records;	}    }}?>